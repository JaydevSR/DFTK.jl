<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Creating supercells with pymatgen · DFTK.jl</title><link rel="canonical" href="https://docs.dftk.org/stable/examples/pymatgen/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">DFTK.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/input_output/">Input and output formats</a></li><li><a class="tocitem" href="../../guide/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Introduction to periodic problems</a></li><li><a class="tocitem" href="../../guide/density_functional_theory/">Density-functional theory</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li class="is-active"><a class="tocitem" href>Creating supercells with pymatgen</a></li><li><a class="tocitem" href="../ase/">Creating slabs with ASE</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li><a class="tocitem" href="../scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Advanced topics</span><ul><li><a class="tocitem" href="../../advanced/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../advanced/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../advanced/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../advanced/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Creating supercells with pymatgen</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Creating supercells with pymatgen</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/pymatgen.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Creating-supercells-with-pymatgen"><a class="docs-heading-anchor" href="#Creating-supercells-with-pymatgen">Creating supercells with pymatgen</a><a id="Creating-supercells-with-pymatgen-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-supercells-with-pymatgen" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=v0.5.0/examples/pymatgen.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/v0.5.0/examples/pymatgen.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>The <a href="https://pymatgen.org/">Pymatgen</a> python library allows to setup solid-state calculations using a flexible set of classes as well as an API to an online data base of structures. Its <code>Structure</code> and <code>Lattice</code> objects are directly supported by the DFTK <code>load_atoms</code> and <code>load_lattice</code> functions, such that DFTK may be readily used to run calculation on systems defined in pymatgen. Using the <code>pymatgen_structure</code> function a conversion from DFTK to pymatgen structures is also possible. In the following we use this to create a silicon supercell and find its LDA ground state using direct minimisation. To run this example Julia&#39;s <code>PyCall</code> package needs to be able to find an installation of <code>pymatgen</code>.</p><p>First we setup the silicon lattice in DFTK.</p><pre><code class="language-julia">using DFTK

a = 10.263141334305942  # Lattice constant in Bohr
lattice = a / 2 .* [[0 1 1.]; [1 0 1.]; [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8];</code></pre><p>Next we make a <code>[2, 2, 2]</code> supercell using pymatgen</p><pre><code class="language-julia">pystruct = pymatgen_structure(lattice, atoms, positions)
pystruct.make_supercell([2, 2, 2])
lattice   = load_lattice(pystruct)
positions = load_positions(pystruct)
atoms     = fill(Si, length(positions));</code></pre><p>Setup an LDA model and discretize using a single k-point and a small <code>Ecut</code> of 5 Hartree.</p><pre><code class="language-julia">model = model_LDA(lattice, atoms, positions)
basis = PlaneWaveBasis(model; Ecut=5, kgrid=(1, 1, 1))</code></pre><pre class="documenter-example-output">PlaneWaveBasis discretization:
    Ecut                 : 5.0 Ha
    fft_size             : (32, 32, 32), 32768 total points
    kgrid type           : Monkhorst-Pack
    kgrid                : [1, 1, 1]
    num. irred. kpoints  : 1

    Discretized Model(lda_x+lda_c_pw, 3D):
        lattice (in Bohr)    : [0         , 10.2631   , 10.2631   ]
                               [10.2631   , 0         , 10.2631   ]
                               [10.2631   , 10.2631   , 0         ]
        unit cell volume     : 2162.1 Bohr³
    
        atoms                : Si₁₆
        atom potentials      : ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
    
        num. electrons       : 64
        spin polarization    : none
        temperature          : 0 Ha
    
        terms                : Kinetic()
                               AtomicLocal()
                               AtomicNonlocal()
                               Ewald()
                               PspCorrection()
                               Hartree()
                               Xc([:lda_x, :lda_c_pw])</pre><p>Find the ground state using direct minimisation and newton (always using SCF is boring ...)</p><pre><code class="language-julia">scfres = direct_minimization(basis; tol=1e-3);
ψ, _ = DFTK.select_occupied_orbitals(basis, scfres.ψ, scfres.occupation)
scfres_newton = newton(basis, ψ; tol=1e-12)</code></pre><pre class="documenter-example-output">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [0.0, 0.14054984958423578, 0.5621993983369431, 1.264948646258122, 2.2487975933477724, 3.513746239605895, 3.513746239605895, 2.2487975933477724, 1.264948646258122, 0.5621993983369431  …  1.1243987966738864, 2.014547844040713, 3.185796590576011, 4.638145036279781, 4.12279558780425, 2.7641470418233043, 1.6865981950108295, 0.8901490473668268, 0.37479959889129544, 0.14054984958423578]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [-0.3000838204844399 -0.38651676076137903 … -0.6442304016759204 -0.38651676076137265; -0.38651676076137914 -0.768132121776889 … -0.2500340648365427 -0.24218268965121173; … ; -0.6442304016759205 -0.25003406483654256 … -3.0211542861086325 -1.4664153489044962; -0.3865167607613723 -0.24218268965121167 … -1.466415348904496 -0.7681321217768756;;; -0.3865167607613794 -0.7681321217768898 … -0.25003406483654234 -0.24218268965121173; -0.7681321217768898 -1.8161936706060218 … -0.13699557143111138 -0.312988420493962; … ; -0.25003406483654256 -0.1369955714311113 … -0.9870510298301364 -0.5277759153846058; -0.24218268965121126 -0.3129884204939619 … -0.5277759153846058 -0.3129884204939551;;; -0.6442304016759322 -1.4664153489045144 … -0.08831357031438808 -0.25003406483654783; -1.4664153489045144 -4.114878101698644 … -0.14040892324045914 -0.5277759153846148; … ; -0.08831357031438869 -0.14040892324045884 … -0.26983750242606713 -0.14040892324045487; -0.2500340648365478 -0.5277759153846147 … -0.14040892324045426 -0.1369955714311098;;; … ;;; -0.9859863776629684 -0.35824744851609447 … -4.090627806711926 -2.29024663594557; -0.3582474485160943 -0.08635610801077073 … -1.4293432742461814 -0.8160371791714962; … ; -4.090627806711926 -1.4293432742461816 … -8.358403967979397 -8.33163370910521; -2.29024663594557 -0.8160371791714959 … -8.33163370910521 -5.7704684544717795;;; -0.6442304016759217 -0.25003406483654367 … -3.021154286108632 -1.466415348904497; -0.25003406483654367 -0.13699557143111163 … -0.9870510298301353 -0.5277759153846068; … ; -3.021154286108632 -0.9870510298301354 … -12.395558685839045 -8.358412346516113; -1.4664153489044969 -0.5277759153846068 … -8.358412346516113 -4.114878101698615;;; -0.3865167607613733 -0.24218268965121195 … -1.4664153489044964 -0.7681321217768768; -0.24218268965121206 -0.31298842049396153 … -0.5277759153846063 -0.3129884204939567; … ; -1.4664153489044964 -0.5277759153846062 … -8.358412346516115 -4.114878101698615; -0.7681321217768764 -0.3129884204939567 … -4.114878101698615 -1.8161936706059967]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), ComplexF64[0.039452912441695784 + 0.0im 0.061120189138426866 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.035545620743758055 - 0.014723478195035009im 0.05414494805835375 - 0.022427571819756905im … 0.0037550740153000865 - 0.009065550615452249im -0.0037550740153000865 + 0.009065550615452249im; … ; 2.259285387562093e-18 + 0.036896930431453305im 3.3437812305071837e-18 + 0.054608091620134955im … -0.018575895426229238 + 4.09595376946258e-17im 0.0 - 0.0im; 0.014723478195035012 + 0.035545620743758055im 0.022427571819756905 + 0.05414494805835375im … 0.009065550615452257 + 0.003755074015300066im 0.009065550615452257 + 0.003755074015300066im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [0.4147537431706757 0.39667717340416875 … 0.35153735663283214 0.39667717340102604; 0.3966771734027325 0.37893916767097363 … 0.3294684992391822 0.3773084908157881; … ; 0.35153735663453944 0.3294684992436685 … 0.30553228031882546 0.336927244148607; 0.3966771734024089 0.37730849081914336 … 0.3369272441485223 0.37893916766871555;;; 0.3966771734025611 0.3789391676719591 … 0.3294684992382563 0.3773084908149749; 0.3789391676706545 0.3562927712456371 … 0.3081672339814748 0.36133865102732426; … ; 0.3294684992409747 0.30816723398687323 … 0.292529569356313 0.3213553062034621; 0.3773084908167255 0.3613386510308594 … 0.32135530620285374 0.3613386510263428;;; 0.3515373566367952 0.3369272441540525 … 0.2762473056998815 0.3294684992406173; 0.336927244152383 0.3170936259042977 … 0.2653418753147686 0.3213553062057791; … ; 0.27624730570387723 0.2653418753214739 … 0.23782576133256406 0.26534187531559844; 0.32946849924287774 0.3213553062100293 … 0.26534187531420245 0.3081672339830387;;; … ;;; 0.3043050825493993 0.2747728361238565 … 0.2897747264779629 0.3020547627228957; 0.27477283612125775 0.24249812765357806 … 0.26708985528532936 0.2793703352845048; … ; 0.28977472648130437 0.2670898552913154 … 0.2926353972991412 0.2926353972982623; 0.3020547627248308 0.2793703352891353 … 0.29263539729673205 0.29811662666532085;;; 0.35153735663856517 0.32946849924712374 … 0.3055322803212255 0.3369272441521697; 0.3294684992449838 0.30816723398942963 … 0.2925295693591279 0.32135530620753106; … ; 0.30553228032326096 0.2925295693636806 … 0.2835430036861755 0.2926353972941818; 0.33692724415354464 0.3213553062112976 … 0.2926353972934365 0.3170936259032365;;; 0.3966771734041129 0.37730849082028545 … 0.3369272441498032 0.37893916767046176; 0.377308490818516 0.36133865103104346 … 0.32135530620492114 0.3613386510287688; … ; 0.33692724415117514 0.32135530620898306 … 0.29263539729188115 0.31709362590126483; 0.37893916767165875 0.36133865103217466 … 0.31709362590114026 0.3562927712449818]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [-0.5113149641922582 -0.5025077544812533 … -0.4766324832567501 -0.5025077544805473; -0.5025077544814401 -0.48588487145981696 … -0.47647042401477396 -0.4966568013383435; … ; -0.4766324832553356 -0.47647042401435225 … -0.38910353530514463 -0.44527691908195927; -0.5025077544803289 -0.4966568013383814 … -0.4452769190835372 -0.48588487145851;;; -0.502507754480746 -0.4858848714594189 … -0.47647042401398776 -0.4966568013375501; -0.4858848714598822 -0.44768088614556306 … -0.46911089882403406 -0.4889624560162948; … ; -0.47647042401357903 -0.46911089882430923 … -0.43613878734899236 -0.4661303640473419; -0.49665680133760165 -0.48896245601627886 … -0.46613036404814284 -0.4889624560151043;;; -0.47663248325721563 -0.4452769190843378 … -0.4562036919093466 -0.47647042401445144; -0.4452769190846717 -0.38057362659250327 … -0.4513650797542349 -0.46613036404956737; … ; -0.4562036919097152 -0.45136507975505297 … -0.43634911904925977 -0.4513650797532355; -0.47647042401471135 -0.4661303640497289 … -0.451365079753424 -0.469110898823623;;; … ;;; -0.4421917735611016 -0.44991004399630374 … -0.354522962001421 -0.4023490353987996; -0.449910043996018 -0.44169614402815055 … -0.404106810059728 -0.43555414003893256; … ; -0.35452296200011113 -0.4041068100590564 … -0.2948006187987299 -0.2948006187955707; -0.4023490353984309 -0.4355541400389877 … -0.29480061879648994 -0.33757346153940143;;; -0.4766324832584077 -0.4764704240169816 … -0.3891035353071132 -0.44527691908503103; -0.4764704240168433 -0.46911089882705276 … -0.43613878735155787 -0.46613036405072433; … ; -0.38910353530442215 -0.43613878734989087 … -0.2118652461922219 -0.2948006187932133; -0.44527691908426936 -0.46613036405039737 … -0.2948006187958999 -0.3805736265924413;;; -0.5025077544815622 -0.49665680133940093 … -0.4452769190846888 -0.48588487145985854; -0.49665680133935375 -0.48896245601761695 … -0.46613036404995195 -0.488962456017044; … ; -0.44527691908226774 -0.4661303640486454 … -0.2948006187946724 -0.3805736265905381; -0.4858848714592791 -0.4889624560169073 … -0.38057362659293836 -0.447680886145315])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [0.0, 0.14054984958423578, 0.5621993983369431, 1.264948646258122, 2.2487975933477724, 3.513746239605895, 3.513746239605895, 2.2487975933477724, 1.264948646258122, 0.5621993983369431  …  1.1243987966738864, 2.014547844040713, 3.185796590576011, 4.638145036279781, 4.12279558780425, 2.7641470418233043, 1.6865981950108295, 0.8901490473668268, 0.37479959889129544, 0.14054984958423578]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [-0.39664504150602237 -0.49234734183846357 … -0.7693255282998384 -0.4923473418408939; -0.49234734184008677 -0.8750778255657323 … -0.3970359896121345 -0.36153100017376716; … ; -0.7693255282967166 -0.3970359896072263 … -3.1047255410949517 -1.5747650238378483; -0.49234734183929235 -0.3615310001704497 … -1.574765023839511 -0.87507782556667;;; -0.49234734183956436 -0.8750778255643497 … -0.3970359896122738 -0.3615310001737869; -0.8750778255661176 -1.9075817855059476 … -0.2979392362736707 -0.44061222548293255; … ; -0.3970359896091469 -0.2979392362685473 … -1.1306602478228158 -0.6725509732284856; -0.3615310001720874 -0.4406122254793814 … -0.6725509732298949 -0.44061222548271656;;; -0.7693255282963526 -1.5747650238347997 … -0.2682699565238532 -0.397035989610382; -1.5747650238368032 -4.17835810238685 … -0.32643212767992547 -0.672550973228403; … ; -0.26826995652022667 -0.3264321276740379 … -0.46836086014276285 -0.32643212767809193; -0.3970359896083814 -0.6725509732243142 … -0.3264321276796758 -0.2979392362716941;;; … ;;; -1.1238730686746707 -0.5333846563885417 … -4.1553760422353845 -2.390540908621474; -0.5333846563908546 -0.2855541243853432 … -1.56636022902058 -0.972220983925924; … ; -4.155376042230733 -1.5663602290139225 … -8.360569189478985 -8.333798930602518; -2.3905409086191702 -0.9722209839213483 … -8.333798930604969 -5.80992528934586;;; -0.7693255282957643 -0.3970359896064015 … -3.10472554109452 -1.5747650238373585; -0.3970359896084032 -0.29793923626873475 … -1.1306602478225654 -0.6725509732278001; … ; -3.104725541089793 -1.1306602478163457 … -12.323880928345092 -8.360577568015144; -1.5747650238352215 -0.6725509732237065 … -8.360577568018577 -4.178358102387819;;; -0.49234734183882256 -0.36153100017032747 … -1.574765023839382 -0.8750778255662737; -0.36153100017204987 -0.440612225480535 … -0.6725509732296371 -0.44061222548223195; … ; -1.5747650238355893 -0.6725509732242685 … -8.360577568018906 -4.178358102387888; -0.8750778255644968 -0.44061222547868933 … -4.178358102390413 -1.9075817855063297]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), ComplexF64[0.039452912441695784 + 0.0im 0.061120189138426866 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.035545620743758055 - 0.014723478195035009im 0.05414494805835375 - 0.022427571819756905im … 0.0037550740153000865 - 0.009065550615452249im -0.0037550740153000865 + 0.009065550615452249im; … ; 2.259285387562093e-18 + 0.036896930431453305im 3.3437812305071837e-18 + 0.054608091620134955im … -0.018575895426229238 + 4.09595376946258e-17im 0.0 - 0.0im; 0.014723478195035012 + 0.035545620743758055im 0.022427571819756905 + 0.05414494805835375im … 0.009065550615452257 + 0.003755074015300066im 0.009065550615452257 + 0.003755074015300066im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[9.304650341523599e-7 - 7.719935452704663e-8im 9.435148894430697e-6 + 6.563440377937433e-7im … -0.026933523206834054 - 0.08004632840370854im -7.862733712473163e-6 + 6.452617751763851e-6im; 3.8535170678701635e-6 - 5.388964810344885e-5im -4.028457204498246e-6 - 1.0870266042299255e-5im … 1.0745390155426846e-5 - 7.292631338630125e-6im 6.869158028915154e-6 - 1.6060307001311016e-5im; … ; 0.12703061381871872 - 0.010023668455182001im -2.3263443371628817e-5 + 8.410183236170966e-6im … 0.11691314243283085 - 0.10520249096115289im -7.062496215658166e-5 + 2.1545540415831308e-5im; 1.1390628269873922e-5 + 5.567010633954759e-5im -4.754962122342868e-6 + 1.0697381180984787e-6im … 2.4833638018993758e-5 + 9.380658130090147e-5im 5.967935681564478e-6 - 2.881111331106739e-6im;;; -7.914458157399901e-6 - 1.0525511728608354e-6im -3.8331584437362225e-6 + 1.2016775047522578e-6im … -1.2542588851241474e-5 + 4.2090737922477706e-6im -1.2696963848372016e-5 + 2.5612552798570292e-6im; -1.4230471912965578e-5 - 1.8738158224287712e-5im 1.1080102319038932e-5 - 1.3763499151771347e-5im … -1.1065337532469255e-5 - 9.102738358652538e-6im 6.857139552907113e-5 - 6.7248139327876e-5im; … ; -2.0569540533332353e-5 + 3.5676975425936773e-7im -9.372263396167849e-7 + 3.501345103779667e-7im … -3.661483964889539e-5 + 8.22177866270798e-6im 4.883379852206363e-6 - 2.924665495396996e-7im; -1.2009487273518913e-5 - 3.744299271650188e-6im 2.3137242102111334e-5 + 6.440946380174867e-5im … -1.2335068715590963e-5 + 1.3462901545824882e-5im 7.831692936487424e-5 + 1.168949347251548e-5im;;; 0.06121742431694715 + 0.08968345047782735im -2.2203805902183675e-5 - 3.511047298656156e-5im … 0.00991298499432417 + 0.00278650009760858im -1.732999512896849e-5 - 1.1537372576491533e-5im; -1.6716471268845322e-5 - 9.587407846202012e-5im 1.644934014621388e-5 + 6.5111303018661555e-6im … -6.103411083599304e-6 - 3.9117172154159294e-5im 1.5649573858162502e-5 - 2.5956347884423407e-6im; … ; 0.054430595652913 + 0.02303304304396582im -4.853581424820232e-6 - 1.4021058204679219e-5im … 0.03731595837231347 - 0.059958084121897376im -2.546999375924919e-5 + 1.1077514802250875e-5im; -9.246565324431199e-7 + 7.100150036303827e-6im 8.459944304561701e-6 + 7.999464087996942e-6im … 1.2081194696830547e-5 + 3.881924418074063e-5im 4.2946924612680845e-6 - 2.0857771415163432e-6im;;; … ;;; -3.7187580647552914e-6 + 2.067155488983709e-6im 4.86001096229536e-6 - 1.777789327113144e-6im … -1.1556329250404389e-5 + 7.213605642109132e-6im -2.02468031308681e-6 - 2.652984507834696e-7im; -1.2231373841514652e-5 - 1.0165639752858648e-5im -4.725007009026981e-5 - 3.902938598034089e-6im … -7.2372244385933346e-6 + 9.010774709017555e-6im -1.4124670424614095e-6 - 2.2521415548239224e-5im; … ; -2.356259117178295e-5 + 1.4515498044304653e-6im 8.350064717300939e-6 - 1.3198884646240864e-6im … -1.925106865166993e-5 + 4.093421038625848e-6im 7.630535722471096e-6 - 5.351005560484137e-7im; -7.139349325421143e-6 + 5.163519568426461e-7im -1.913716663281521e-5 + 2.8840635080852465e-5im … -1.7530899620113682e-7 + 2.2428940039943906e-5im 3.320044093235097e-5 + 1.0869412171198255e-5im;;; 0.06121742432058012 + 0.08968345047898967im -1.0954368480471246e-5 - 1.367375097135131e-5im … 0.04004272846290285 + 0.01125634602774001im -4.291428981003894e-5 - 2.817068373246741e-5im; -3.702662956769881e-6 - 3.3281186545712615e-5im 5.378496077026776e-7 - 5.088305701581946e-6im … 3.57844709876211e-6 + 1.6616270854853874e-5im 1.9345176204623506e-5 + 3.578698091557404e-7im; … ; 0.21987426434993132 + 0.09304346041290755im -6.489075707444587e-5 - 9.476822277780912e-6im … 0.1613124856877213 - 0.0003863780174428594im -0.00010401602499699092 - 1.3856618433603396e-5im; -7.692399867061389e-6 + 3.5300123098493005e-5im 1.2155545893070512e-5 + 1.0952967451548809e-5im … 4.563033080882379e-6 + 6.257750582672963e-5im 2.7346584681833018e-5 + 1.5220225279487471e-5im;;; -8.60953027143575e-6 + 2.351604870306154e-6im 4.596495864106822e-6 - 1.845823924920302e-6im … -2.135764290068117e-5 + 1.2329656456720288e-5im -3.5976356483246303e-6 - 5.453955525800133e-7im; -2.3846225385330118e-5 - 2.2694104467625207e-5im -4.962022703866693e-5 - 1.1047779851755942e-5im … -1.965620769534942e-5 + 1.742264406395908e-6im 5.559458864782948e-6 - 6.376774982779091e-5im; … ; -3.942823072638982e-5 + 3.6572030141644964e-6im 1.557955002571276e-5 - 3.0182874712447226e-6im … -5.162639024391922e-5 + 1.3261617380300112e-5im 1.8820895432294406e-5 - 3.3026766326863234e-6im; -1.8661165075585515e-5 - 5.514690422289256e-6im -3.987469575269691e-5 + 6.788985341802974e-5im … -1.7122539146669526e-5 + 2.279554353406779e-5im 1.2888044805259535e-5 + 1.4299476381980323e-5im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), energies = Energies(total = -62.277715861368854), converged = true, ρ = [0.09610720131571888 0.09085401337857187 … 0.07655587366837868 0.09085401337815878; 0.09085401337868115 0.08147776990917976 … 0.0764715184071374 0.0874743305326087; … ; 0.07655587366764213 0.07647151840691797 … 0.03956580495551274 0.06138424717665703; 0.09085401337803098 0.0874743305326303 … 0.06138424717736385 0.0814777699084697;;; 0.09085401337827509 0.0814777699089635 … 0.07647151840672833 0.08747433053215628; 0.08147776990921522 0.06246757364713321 … 0.07270707893155984 0.08316148815178405; … ; 0.07647151840651567 0.07270707893169819 … 0.0573830845259239 0.07121914196956819; 0.0874743305321857 0.08316148815177529 … 0.07121914196996523 0.0831614881511282;;; 0.07655587366862109 0.06138424717772248 … 0.06641329348181674 0.07647151840696959; 0.06138424717787207 0.036803198325976914 … 0.06415300528490242 0.07121914197067136; … ; 0.06641329348199095 0.06415300528528008 … 0.05747311921068233 0.06415300528444104; 0.07647151840710481 0.07121914197075142 … 0.06415300528452808 0.07270707893135323;;; … ;;; 0.06001281548365791 0.06348370462443981 … 0.029186011400244235 0.04413141881746458; 0.06348370462430884 0.05979446095608591 … 0.04476312021536308 0.057133325566910566; … ; 0.02918601139989115 0.044763120215120585 … 0.01592508414638572 0.015925084145823665; 0.044131418817332714 0.05713332556693413 … 0.015925084145987214 0.0248574432074438;;; 0.07655587366924183 0.0764715184082861 … 0.039565804956166156 0.06138424717803304; 0.07647151840821416 0.07270707893307746 … 0.05738308452702152 0.07121914197124486; … ; 0.03956580495527293 0.05738308452630831 … 0.005337878765196354 0.01592508414540427; 0.06138424717769181 0.07121914197108282 … 0.015925084145882246 0.03680319832595736;;; 0.09085401337875255 0.08747433053321167 … 0.0613842471778797 0.08147776990920233; 0.08747433053318472 0.08316148815251247 … 0.07121914197086202 0.0831614881521968; … ; 0.06138424717679518 0.07121914197021435 … 0.01592508414566386 0.036803198325356126; 0.08147776990888758 0.08316148815212146 … 0.03680319832611434 0.06246757364702073;;;;], eigenvalues = Any[[-0.16217594588185635, -0.07512573394417095, -0.0751257339436535, -0.07512573394289415, -0.07512573394271273, -0.010168114055081183, -0.01016811405446584, -0.010168114054249404, -0.01016811405387667, -0.010168114053691252  …  0.22436299901291173, 0.224362999013082, 0.22436299901338214, 0.22436299901384923, 0.22436299901441037, 0.22436299901489004, 0.22436299901529602, 0.2705989718879183, 0.2705989718885563, 0.27059897188954884]], occupation = [[2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0  …  2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0]], εF = nothing, n_iter = 4, ψ = Matrix{ComplexF64}[[-0.9537190115046427 + 0.07912713710802097im 2.3057826356624075e-11 - 7.549488576688174e-12im … -1.1002951852314823e-12 + 1.5236197304969122e-12im 2.1586825438006554e-12 - 8.374942637015941e-13im; 1.50357411347495e-11 + 2.1001660487108236e-11im 0.23786659227509474 - 0.07856209877341108im … 6.922228808496807e-12 + 1.494977712045327e-12im -2.996167260488022e-12 - 2.2870987601616294e-12im; … ; 8.553023725366189e-14 + 1.5462699965187454e-12im -1.3263105182296689e-11 - 1.584431630542403e-11im … 4.100869087871376e-11 + 1.0417370244866265e-10im 4.813575495603371e-11 - 1.2198592960746741e-11im; 7.574273890378902e-12 + 3.233866600611639e-11im 0.10466631900909144 + 0.3172241242429848im … 1.4208529237067294e-12 - 4.035483095420327e-12im 1.2019631472038553e-13 - 1.7031077611563694e-12im]], stage = :finalize, algorithm = &quot;Newton&quot;)</pre><pre><code class="language-julia">scfres_newton.energies</code></pre><pre class="documenter-example-output">Energy breakdown (in Ha):
    Kinetic             25.7697876
    AtomicLocal         -18.8616201
    AtomicNonlocal      14.8540134
    Ewald               -67.1831486
    PspCorrection       -2.3569765
    Hartree             4.8508714 
    Xc                  -19.3506430

    total               -62.277715861369</pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../metallic_systems/">« Temperature and metallic systems</a><a class="docs-footer-nextpage" href="../ase/">Creating slabs with ASE »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 20 March 2022 18:55">Sunday 20 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
